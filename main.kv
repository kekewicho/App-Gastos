#:import WipeTransition kivy.uix.screenmanager.WipeTransition
<Cards>:
	elevation:2
	orientation: "vertical"
	size_hint: .6, None
	height: self.minimum_height
	pos_hint: {"center_x": .5, "center_y": .5}
	padding:10

<OPItem>:
    size_hint_y: None
    height: '60sp'
    radius:1
    MDCardSwipeLayerBox:
		MDIconButton:
			icon:'delete'
			theme_icon_color: "Custom"
			icon_color: '#990000'
			id:btnDelete
			on_release:
				root.parent.remove_widget(root)
				app.delete_op(root.key,root.op,root.monto)
		MDIconButton:
			icon:'pencil'
			theme_icon_color: "Custom"
			icon_color: '#3082a9'
			id:btnEdit
			on_release:
				app.edit_op(root.key,root.op,root)
    MDCardSwipeFrontBox:
		ripple_behavior:True
		focus_behavior: True
		radius:0
		orientation:'vertical'
		padding:15
		spacing:5
		on_release:root.open_card() if root.state=='closed' else root.close_card()
		MDLabel:
			text:root.monto
			bold:True
			font_size:'16sp'
		MDLabel:
			text:root.descripcion
			shorten:True
			font_size:'14sp'
			theme_text_color: "Custom"
			text_color: '#a7a7a7'

<ContentNvoPrestamo>:
	orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "60dp"

    MDTextField:
        id: descripcion
        error:False
        hint_text: "Descripción"
        helper_text_mode: "on_error"
        helper_text: "Ingresa un valor válido"
        on_text: self.error=False

<Buttons>:
	padding:2
	spacing:15
	size_hint_y:None
	height:"60dp"
	MDAnchorLayout:
		anchor_x:'center'
		anchor_y:'center'
		MDFillRoundFlatIconButton:
			text:'Ingreso' if app.root.ids.scr_manager.current=='ingre_egre' else 'Abono'
			icon:'cash-plus'
			md_bg_color:'#086001'
			on_release:
				app.root.registro('ingreso') if app.root.ids.scr_manager.current=='ingre_egre' else root.registro('ingresos',root.parent.panel_cls.text)
	MDAnchorLayout:
		anchor_x:'center'
		anchor_y:'center'
		MDFillRoundFlatIconButton:
			text:'Egreso' if app.root.ids.scr_manager.current=='ingre_egre' else 'Préstamo'
			icon:'cash-remove'
			md_bg_color:'#7d0204'
			on_release:
				app.root.registro('egreso') if app.root.ids.scr_manager.current=='ingre_egre' else root.registro('egresos',root.parent.panel_cls.text)

<Content>
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "120dp"

    MDTextField:
        id: monto
        error:False
        hint_text: "Monto"
        helper_text_mode: "on_error"
        helper_text: "Ingresa un valor válido"
        on_text: self.error=False

    MDTextField:
        id: descripcion
        error: False
        hint_text: "Descripción" if app.root.ids.scr_manager.current=='ingre_egre' else 'Fecha'
        helper_text_mode: "on_error"
        helper_text: "Ingresa un valor válido"
        on_text: self.error=False
		on_focus:if app.root.ids.scr_manager.current=='fondo': root.show_calendar()

<Scr>:
	MDNavigationLayout:
		ScreenManager:
			id:scr_manager
			transition:WipeTransition()
			Screen:
				name: 'ingre_egre'
				md_bg_color:1,1,1,1
				MDBoxLayout:
					size_hint_x:.9
					orientation:'vertical'
					pos_hint:{'center_x':.5,'center_y':.5}
					spacing:50
					padding:0,'5dp',0,'30dp'
					MDBoxLayout:
						size_hint_y:None
						height:self.minimum_height
						MDIconButton:
							icon:'menu'
							pos_hint:{'x':.05,'top':1}
							on_release:nav_drawer.set_state('open')
						MDLabel:
							id:lblUser
							halign:'right'
							valign:'center'
							text:'¡Wendía, '
							font_size:'16sp'
							#adaptive_height:True
							bold:True
					MDBoxLayout:
						size_hint_y:.08
						id:slotquince
						MDIconButton:
							icon:"chevron-left"
							on_release:root.trasladar_quincena('previous')
						MDLabel:
							id:quincena
							halign:'center'
							valign:'center'
							text:'[QUINCENA ACTUAL]'
						MDIconButton:
							icon:'chevron-right'
							on_release:root.trasladar_quincena('next')
					MDLabel:
						bold:True
						halign:'center'
						size_hint_y:.1
						text:'Balance: '
						id:balance
						font_size:sp(20)
						theme_text_color: "Custom"
						text_color: "red" if '-' in self.text else 'black'
					MDBoxLayout:
						size_hint_y:.1
						MDFloatLayout:
						MDFillRoundFlatIconButton:
							text:'Ingreso'
							icon:'cash-plus'
							md_bg_color:'#7cd16f'
							on_release:root.registro('ingresos');print(platform=='win')
						MDFloatLayout:
							size_hint_x:.5
						MDFillRoundFlatIconButton:
							text:'Egreso'
							icon:'cash-remove'
							md_bg_color:'#bf1336'
							on_release:root.registro('egresos')
						MDFloatLayout:
					MDBoxLayout:
						spacing:15
						MDBoxLayout:
							orientation:'vertical'
							spacing:15
							MDLabel:
								text:'Ingresos'
								halign:'center'
								size_hint_y:.1
							ScrollView:
								MDList:
									id:ingresos
						MDBoxLayout:
							orientation:'vertical'
							spacing:15
							MDLabel:
								text:'Egresos'
								halign:'center'
								size_hint_y:.1
							ScrollView:
								MDList:
									id:egresos
			Screen:
				name: 'fondo'
				MDFloatLayout:
					ScrollView:
						MDGridLayout:
							row_default_height:10
							adaptive_height:True
							cols:1
							id:layout_fondo
							padding:'15dp','60dp','15dp','15dp'
							spacing:'20dp'
							MDAnchorLayout:
								anchor_x:'center'
								anchor_y:'center'
								size_hint_y:None
								height:50
								MDLabel:
									bold:True
									halign:'center'
									text:'Total Ahorros: '
									id:ahorrado
									font_size:sp(20)
									theme_text_color: "Custom"
									text_color: "red" if '-' in self.text else 'black'
									size_hint_y:None
									adaptive_height: True
							MDRaisedButton:
								text:'+ Nuevo prestamo'
								size_hint_x:1
								on_release:root.nuevo_prestamo()
					MDIconButton:
						icon:'menu'
						pos_hint:{'x':.05,'top':1}
						on_release:nav_drawer.set_state('open')
		MDNavigationDrawer:
			id:nav_drawer
			MDBoxLayout:
				orientation:'vertical'
				MDFloatLayout:
					size_hint_y:.05
				MDRectangleFlatIconButton:
					font_size:sp(20)
					halign:'left'
					size_hint_x:1
					icon: "sack"
					text: "Ahorros"
					theme_text_color: "Custom"
					text_color: "black"
					line_color: "white"
					theme_icon_color: "Custom"
					icon_color: "black"
					on_release:
						nav_drawer.set_state('close')
						scr_manager.current='fondo'
				MDRectangleFlatIconButton:
					font_size:sp(20)
					halign:'left'
					size_hint_x:1
					icon: "cash-multiple"
					text: "Cuentas quincenales"
					theme_text_color: "Custom"
					text_color: "black"
					line_color: "white"
					theme_icon_color: "Custom"
					icon_color: "black"
					on_release:
						nav_drawer.set_state('close')
						scr_manager.current='ingre_egre'
				MDFloatLayout:
